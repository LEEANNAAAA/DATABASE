--1 사원의 이름, 부서명, 같은 등급의 최하위 봉급 출력하는 sql
SELECT E.ENAME, D.DNAME, S.LOSAL
FROM EMP E JOIN DEPT D ON E.DEPTNO=D.DEPTNO
JOIN SALGRADE S ON SAL BETWEEN S.LOSAL AND S.HISAL;

SELECT E.ENAME, D.DNAME, S.LOSAL
FROM EMP E, DEPT D, SALGRADE S
WHERE E.DEPTNO = D.DEPTNO AND SAL BETWEEN S.LOSAL AND S.HISAL;

SELECT E.ENAME, D.DNAME, S.LOSAL
FROM EMP E NATURAL JOIN SALGRADE S NATURAL JOIN DEPT D
WHERE SAL BETWEEN S.LOSAL AND S.HISAL;

SELECT E.ENAME, D.DNAME, S.LOSAL
FROM EMP E JOIN DEPT D USING(DEPTNO)
JOIN SALGRADE S ON(E.SAL BETWEEN S.LOSAL AND S.HISAL);

SELECT * FROM EMP E NATURAL JOIN DEPT D;

--2 모든 사원은 다 나오게하고 해당 부서를 나오게, ​사원이름, 부서번호, 급여, 부서명 출력
INSERT INTO EMP(EMPNO, ENAME, sal) VALUES (1,'A',1000);
select * from emp;

SELECT E.ENAME, E.EMPNO, E.SAL, D.DNAME
FROM EMP E, DEPT D, SALGRADE S
WHERE E.DEPTNO=D.DEPTNO AND E.SAL BETWEEN S.LOSAL AND S.HISAL;

SELECT E.ENAME, E.DEPTNO, E.SAL, D.DNAME
FROM EMP E, DEPT D 
WHERE E.DEPTNO = D.DEPTNO(+);

select e.ename,e.empno,d.dname,e.sal 
from emp e LEFT OUTER JOIN dept d on e.deptno=d.deptno;

--모든 사원, 모든 부서가 다 나오게
SELECT E.ENAME, E.DEPTNO, E.SAL, D.DNAME 
FROM EMP E FULL OUTER JOIN DEPT D ON E.DEPTNO = D.DEPTNO;

--FORD의 부하직원은 SMITH입니다.
SELECT E1.ENAME||'의 부하직원은 '||E2.ENAME||'입니다.'
FROM EMP E1, EMP E2
WHERE E1.EMPNO = E2.MGR;

--​ALLEN의 부서와 같은 부서에 있는 직원들의 이름과 부서번호, 부서명 출력
SELECT E.ENAME, E.DEPTNO, D.DNAME
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.DEPTNO=(SELECT DEPTNO FROM EMP WHERE ENAME='ALLEN');

--ALLEN과 같은 급여 등급인 사람들의 사원이름, 등급, 급여 출력
SELECT E.ENAME, S.GRADE, E.SAL
FROM EMP E, SALGRADE S
WHERE (E.SAL BETWEEN S.LOSAL AND S.HISAL)
AND S.GRADE=(SELECT GRADE FROM EMP E, SALGRADE S 
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL AND E.ENAME='ALLEN');


--전채 평균 급여보다 적게 받는 사원들의 이름과 급여를 급여 역순으로 출력
SELECT ENAME, SAL
FROM EMP
WHERE SAL<(SELECT AVG(SAL) FROM EMP)
ORDER BY SAL DESC;