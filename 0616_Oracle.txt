--1
SELECT ENAME, SAL
FROM EMP;

--2
SELECT *
FROM EMP;

--EMPNO:사원번호, ENAME:사원명, JOB:직급, MGR:관리자번호
--HIREDATE:입사일, SAL:봉급, COMM:보너스, DEPTNO:부서번호

--3 10번 부서 사원명과 부서번호
SELECT ENAME, DEPTNO
FROM EMP
WHERE DEPTNO = 10;

--4 20,30번 부서의 사원명, 부서번호, 봉급
SELECT ENAME, DEPTNO, SAL
FROM EMP
WHERE DEPTNO = 20 OR DEPTNO = 30;

SELECT ENAME, DEPTNO, SAL
FROM EMP
WHERE DEPTNO IN(20,30);

--5 입사일이 1981년인 사원들의 사원명과 입사일, 관리자번호
SELECT ENAME, HIREDATE, MGR
FROM EMP
WHERE TO_CHAR(HIREDATE, 'YYYY') = '1981';

SELECT ENAME, HIREDATE, MGR
FROM EMP
WHERE HIREDATE LIKE '%81%';

SELECT ENAME, HIREDATE, MGR
FROM EMP
WHERE HIREDATE>='1981/01/01' AND HIREDATE<='1981/12/31';

--6 DEPT 테이블 
SELECT *
FROM DEPT;
--DEPTNO:부서번호, DNAME:부서명, LOC:부서위치

--7 SALGRADE 테이블
SELECT *
FROM SALGRADE;
--GRADE:등급, LOSAL:최하위급여, HISAL:최상위급여

--8 20번 부서의 부서번호, 부서명
SELECT DEPTNO, DNAME
FROM DEPT
WHERE DEPTNO = 20;

--9 등급이 1등급 중 최하위 급여와 최고 급여
SELECT LOSAL, HISAL
FROM SALGRADE
WHERE GRADE = 1;

--10 봉급이 3000대인 사원들의 사원명과 급여
SELECT ENAME, SAL
FROM EMP
WHERE SAL>=3000 AND SAL<4000;

--11 부서명이 SALES인 부서의 위치(LOC)출력
SELECT LOC
FROM DEPT
WHERE DNAME = 'SALES';

--12 10번 부서의 위치
SELECT LOC
FROM DEPT
WHERE DEPTNO=10;

--13 10번 부서의 사원명과 부서번호
SELECT ENAME, DEPTNO
FROM EMP
WHERE DEPTNO = 10;

--14 10번 부서의 사원명과 부서번호, 부서명
SELECT ENAME, EMP.DEPTNO, DNAME
FROM EMP,DEPT
WHERE EMP.DEPTNO=DEPT.DEPTNO AND EMP.DEPTNO=10;

--15 사원수
SELECT COUNT(*)
FROM EMP;

--16 부서수
SELECT COUNT(*)
FROM DEPT;

--17 10번 부서에 속한 사원번호, 봉급, 부서명, 부서위치
SELECT EMPNO, SAL, DNAME, LOC
FROM EMP E,DEPT D
WHERE E.DEPTNO=D.DEPTNO AND E.DEPTNO=10;

--18 사원번호, 사원명, 봉급, 등급
SELECT EMPNO, ENAME, SAL, GRADE
FROM EMP E, SALGRADE S
WHERE E.SAL>=S.LOSAL AND E.SAL<=S.HISAL;

SELECT * FROM SALGRADE;

--19 사원번호, 사원명, 부서번호, 부서명, 등급(소속 테이블 다 써주기)
SELECT E.EMPNO, E.ENAME, D.DEPTNO, D.DNAME, S.GRADE
FROM EMP E, DEPT D, SALGRADE S
WHERE E.DEPTNO=D.DEPTNO AND E.SAL>=S.LOSAL AND E.SAL<=S.HISAL
ORDER BY GRADE;

--20 사원의 정보와 그 사원에 대한 부서정보를 사원번호 순으로 검색
SELECT *
FROM EMP E, DEPT D
WHERE E.DEPTNO=D.DEPTNO
ORDER BY E.EMPNO;

--21 사원번호, 사원명, 부서번호, 부서명, 위치를 부서번호, 사원번호 순으로 검색
SELECT E.EMPNO, E.ENAME, D.DEPTNO, D.DNAME, D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO=D.DEPTNO
ORDER BY E.DEPTNO, E.EMPNO;

--22 급여가 3000이상인 사원들의 사원번호, 사원명, 봉급, 부서번호, 부서명, 위치
SELECT E.EMPNO, E.ENAME, E.SAL, D.DEPTNO, D.DNAME, D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO=D.DEPTNO AND E.SAL>=3000;

--23 모든 사원들의 정보와 급여 등급정보(SALGRADE의 모든정보)를 출력
SELECT *
FROM EMP E, SALGRADE S
WHERE E.SAL>=S.LOSAL AND E.SAL<=S.HISAL;

--24 사원들의 사원번호, 사원명, 관리자번호
SELECT EMPNO, ENAME, MGR
FROM EMP;

--25 사원들의 사원번호, 사원명, 관리자번호, 관리자 이름
SELECT EMPNO, ENAME, MGR, (SELECT ENAME FROM EMP WHERE EMPNO=E.MGR) AS MGRNAME
FROM EMP E;

SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.ENAME AS MGRNAME
FROM EMP E1, EMP E2
WHERE E1.MGR=E2.EMPNO;

SELECT *
FROM EMP;

--26 사원번호, 이름, 관리자번호, 관리자의 사원번호, 관리자이름을 사원번호순으로 출력, 단 관리자가 없는 사원도 나오게
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO AS MGR_MPTNO, E2.ENAME AS MGR_ENAME
FROM EMP E1, EMP E2
WHERE E1. MGR=E2.EMPNO(+);    --오른쪽 기준 왼쪽을 채워라

--27
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO AS MGR_MPTNO, E2.ENAME AS MGR_ENAME
FROM EMP E1, EMP E2
WHERE E1. MGR(+)=E2.EMPNO   --왼쪽 기준 오른쪽을 채워라
ORDER BY E1.EMPNO;

--28 사원번호, 사원명, 직급, 관리자번호, 입사일, 급여, 보너스, 부서번호. 부서명, 위치
--부서번호와 사원번호순으로 정렬(FROM EMP E NATURAL JOIN DEPT D) //알아서 자연스럽게 정렬
SELECT E.EMPNO, E.ENAME, E.JOB, E.MGR, E.HIREDATE, E.SAL, E.COMM, DEPTNO, D.DNAME, D.LOC
FROM EMP E NATURAL JOIN DEPT D
ORDER BY DEPTNO, E.EMPNO;

--29 사원번호, 사원명, 직급, 관리자번호, 입사일, 급여, 보너스, 부서번호. 부서명, 위치
--급여가 3000이상인 사원들 대상
--부서번호와 사원번호순으로 정렬(FROM EMP E JOIN DEPT D USING(DEPTNO)) //DEPTNO를 사용하라고 알려주는 것
SELECT E.EMPNO, E.ENAME, E.JOB, E.MGR, E.HIREDATE, E.SAL, E.COMM, DEPTNO, D.DNAME, D.LOC
FROM EMP E JOIN DEPT D USING(DEPTNO)
WHERE E.SAL>=3000
ORDER BY DEPTNO, E.EMPNO;

--30 FROM EMP E JOIN DEPT D ON(E.DEPTNO = D.DEPTNO)
SELECT E.EMPNO, E.ENAME, E.JOB, E.MGR, E.HIREDATE, E.SAL, E.COMM, D.DEPTNO, D.DNAME, D.LOC
FROM EMP E JOIN DEPT D ON(E.DEPTNO = D.DEPTNO)
WHERE E.SAL>=3000
ORDER BY D.DEPTNO, E.EMPNO;

--Q1
SELECT D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
FROM EMP E, DEPT D
WHERE E.DEPTNO=D.DEPTNO AND E.SAL>2000
ORDER BY E.DEPTNO;

--Q2
SELECT DEPTNO,
       D.DNAME,
       TRUNC(AVG(SAL)) AS AVG_SAL,
       MAX(SAL) AS MAX_SAL,
       MIN(SAL) AS MIN_SAL,
       COUNT(*) AS CNT
  FROM EMP E JOIN DEPT D USING (DEPTNO)
  GROUP BY DEPTNO, D.DNAME;
  
